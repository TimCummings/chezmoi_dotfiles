# don't "logout" (close window) with CTRL+D
setopt IGNORE_EOF

# shorten escape timeout
KEYTIMEOUT=1

# emacs mode for `^a`, `^e`
bindkey -e

# CTRL-Left-Right jumps words
bindkey "\e[1;5D" backward-word
bindkey "\e[1;5C" forward-word
# MacOS specific
if [[ $OSTYPE == "darwin"* ]]; then
  # real delete (delete forward)
  bindkey "\e[3~" delete-char
# Home and end
  bindkey "^[[H" beginning-of-line
  bindkey "^[[F" end-of-line
fi

# "word characters" are alphanumerics only, like `w` in Vim
# this should e.g. make `^w` stop at nonalphanumerics, not continue until whitespace
autoload -U select-word-style
select-word-style bash

# aliases
alias psf='ps -aux | fzf'
alias vzf='nvim $(fzf)'

alias l='ls -al --color'
if [[ $OSTYPE == "darwin"* ]]; then
  # MacOS
  alias ls='ls -G'
fi

# git
alias g='git'
# other aliases moved to gitconfig

# nnn file manager
alias nnn='nnn-nerd-static -eoR'

# highlight completion selection
zstyle ':completion:*' menu select

# auto completion:
# - first try simple completion `''`
# - then try case sensitive
# - then try case insensitive
zstyle ':completion:*' matcher-list '' 'm:{a-zA-Z-_}={A-Za-z_-}' 'r:|=*' 'l:|=* r:|=*'

# MacOS Homebrew package manager
if [[ $OSTYPE == "darwin"* ]]; then
  eval "$(/opt/homebrew/bin/brew shellenv)"
fi

# First and only argument is the desired term title
function rename_wezterm_title {
  echo "\x1b]1337;SetUserVar=panetitle=$(echo -n $1 | base64)\x07"
}

# asdf version manager
if [ -d "$ASDF_DIR" ]; then
  # append completions to fpath
  fpath=(${ASDF_DIR}/completions $fpath)
  # initialise completions with ZSH's compinit
  autoload -Uz compinit
  compinit
  # source the main script
  . $ASDF_DIR/asdf.sh
  # hook direnv into shell for faster asdf
  eval "$(direnv hook zsh)"
else
  echo "Asdf appears to not be installed, skipping."
fi

# starship prompt
eval "$(starship init zsh)"
